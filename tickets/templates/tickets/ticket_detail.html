{% extends 'base.html' %}

{% block content %}
    <div class="col-12 col-md-6 mx-auto mt-3">
        <article class="border border-secondary rounded-lg pl-2 content-area">
            <div class="">
                <div class="pb-1 mb-3 border-bottom border-success">
                    <a class="mr-2" href="#">{{ object.username }}</a>
                    <small class="text-muted">{{ object.date_posted|date:"d F, Y" }}</small>
                </div>
                <h2><a class="">{{ object.title }}</a></h2>
                <p class="">{{ object.description|safe|linebreaks }}</p>
            </div>
            <div class="mb-1 border-top border-success">
                <div class="my-2">
                {% if object.username == user %}
                    <!-- <div class="border-top border-light py-3"> -->
                        <a class="btn btn-outline-secondary mx-1" href="{% url 'tickets:update' object.id %}">Update</a>
                        <a class="btn btn-danger" href="{% url 'tickets:delete' object.id %}">Delete</a>
                    <!-- </div> -->
                {% else %}
                    {% if object.issue == 'Bug' %}
                        <a class="btn btn-outline-success mx-1" href="{% url 'tickets:vote' pk=object.id %}">Vote</a>
                    {% else %}
                        <a class="btn btn-outline-success mx-1" href="{% url 'cart:add' id=object.id %}">Add to Cart</a>
                    {% endif %}
                {% endif %}
                    {% if user.is_authenticated %}
                        <a class="btn btn-primary btn-comment mx-1" href="{% url 'tickets:add_comment_to_ticket' pk=object.id %}">Add comment</a>
                    {% endif %}
                </div>
            </div>
        </article>
    </div>
    <div class="col-12 col-md-6 mx-auto mt-3">
        {% for comment in object.comments.all %}
            <article class="border border-secondary rounded-lg pl-2 content-area">
                <div class="">
                    <div class="pb-1 mb-3 border-bottom border-success">
                        <span class="mr-2"><strong>{{ comment.username }}</strong>:</span>
                        <small class="text-muted">{{ comment.date_created|date:"d F, Y" }}</small>
                    </div>
                    <p class="">{{ comment.comment|safe|linebreaks }}</p>
                </div> 
            </article>
        {% empty %}
            <p>No comments posted.</p>
        {% endfor %}
    </div>

{% endblock %}
